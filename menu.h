#ifndef CONFETTI_MENU
#define CONFETTI_MENU

const uint8_t UP_BUTTON[72] = {
  0x0, 0x0, 0x01,
  0x0, 0x0, 0x03,
  0x0, 0x0, 0x07,
  0x0, 0x0, 0x0f,
  0x0, 0x0, 0x1f,
  0x0, 0x0, 0x3f,
  0x0, 0x0, 0x7f,
  0x0, 0x0, 0xff,
  0x0, 0x01, 0xff,
  0x0, 0x03, 0xff,
  0x0, 0x07, 0xff,
  0x0, 0x0f, 0xff,
  
  0x0, 0x0f, 0xff,
  0x0, 0x07, 0xff,
  0x0, 0x03, 0xff,
  0x0, 0x01, 0xff,
  0x0, 0x0, 0xff,
  0x0, 0x0, 0x7f,
  0x0, 0x0, 0x3f,
  0x0, 0x0, 0x1f,
  0x0, 0x0, 0x0f,
  0x0, 0x0, 0x07,
  0x0, 0x0, 0x03,
  0x0, 0x0, 0x01,
};

const uint8_t DOWN_BUTTON[72] = {
  0x80, 0x0, 0x0,
  0xc0, 0x00, 0x00,
  0xe0, 0x00, 0x00,
  0xf0, 0x00, 0x00,
  0xf8, 0x00, 0x00,
  0xfc, 0x00, 0x00,
  0xfe, 0x00, 0x00,
  0xff, 0x00, 0x00,
  0xff, 0x80, 0x00,
  0xff, 0xc0, 0x00,
  0xff, 0xe0, 0x00,
  0xff, 0xf0, 0x00,
  
  0xff, 0xf0, 0x00,
  0xff, 0xe0, 0x00,
  0xff, 0xc0, 0x00,
  0xff, 0x80, 0x00,
  0xff, 0x00, 0x00,
  0xfe, 0x00, 0x00,
  0xfc, 0x00, 0x00,
  0xf8, 0x00, 0x00,
  0xf0, 0x00, 0x00,
  0xe0, 0x00, 0x00,
  0xc0, 0x00, 0x00,
  0x80, 0x00, 0x00,
};

uint8_t current_menu_selection = 2;

void updateMenuUI() {
    ttgo->tft->setTextFont(4);
    for (uint8_t i = 0; i < MAXIMUM_ID; i++) {
        ttgo->tft->setTextColor(
            (i == current_menu_selection? TFT_BLACK : TFT_WHITE),
            (i == current_menu_selection? TFT_WHITE : TFT_BLACK)
        );
        ttgo->tft->drawString(menu_list[i].c_str(), 0, 32 + i * 26);
    }

    ttgo->tft->drawBitmap(80-48, 32+96+96-16, UP_BUTTON, 24, 24, TFT_WHITE);
    ttgo->tft->drawRect(120-12, 32+96+96-16, 24, 24, TFT_WHITE);
    ttgo->tft->drawBitmap(160+24, 32+96+96-16, DOWN_BUTTON, 24, 24, TFT_WHITE);
}
void enterMenuScreen() {
    ttgo->tft->fillScreen(TFT_BLACK);
    updateInitUI();
    updateTitleUI("Menu");
    updateMenuUI();

    int16_t x, y;
    uint8_t target = 0;
    while (true) {
        while (!ttgo->getTouch(x, y)) { }


        // up button.
        if (x < 80 && y > 240-32) {
            while (ttgo->getTouch(x, y)) { }
            current_menu_selection -= 1;
            if (current_menu_selection == 255) { current_menu_selection = MAXIMUM_ID-1; }
            updateMenuUI();
            
        } else
        // Back button.
        if (x < 160 && y > 240-32) { while (ttgo->getTouch(x, y)) { } goto leave; }
        else
        // down button.
        if (x > 160 && y > 240-32) {
            while (ttgo->getTouch(x, y)) { }
            current_menu_selection += 1;
            if (current_menu_selection >= MAXIMUM_ID) { current_menu_selection = 0; }
            updateMenuUI();
        }
    }
    leave:
    requested = current_menu_selection;
    ttgo->tft->fillScreen(TFT_BLACK);
}
#endif
